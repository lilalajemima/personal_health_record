{% extends "base.html" %}
{% block title %}Profile{% endblock %}

{% block content %}
<section class="profile-section">
    <div class="container">
        <div class="card profile-card">
            <div class="card-header">
                <h2>Personal Information</h2>
                <p class="text-muted">Update your profile details and demographic information</p>
            </div>
            
            <div class="card-body">
                <form method="POST" enctype="multipart/form-data" class="profile-form">
                    <div class="avatar-upload">
                        <div class="avatar-preview">
                            {% if user.avatar_url %}
                            <img src="{{ user.avatar_url }}" alt="Profile Picture" id="avatarPreview">
                            {% else %}
                            <div class="avatar-placeholder">
                                <i class="fas fa-user"></i>
                            </div>
                            {% endif %}
                        </div>
                        <div class="avatar-upload-controls">
                            <input type="file" id="avatar" name="avatar" accept="image/*" style="display: none;">
                            <button type="button" class="btn btn-outline" onclick="document.getElementById('avatar').click()">
                                <i class="fas fa-camera"></i> Change Photo
                            </button>
                            <small class="text-muted">JPG, GIF or PNG. Max size 2MB</small>
                        </div>
                    </div>

                    <div class="form-grid">
                        <div class="form-group">
                            <label for="name" class="form-label">Full Name</label>
                            <input type="text" id="name" name="name" class="form-control" value="{{ user.name }}">
                        </div>

                        <div class="form-group">
                            <label for="email" class="form-label">Email Address</label>
                            <input type="email" id="email" name="email" class="form-control" value="{{ user.email }}" readonly>
                        </div>

                        <div class="form-group">
                            <label for="age" class="form-label">Age</label>
                            <input type="number" id="age" name="age" class="form-control" value="{{ user.age or '' }}">
                        </div>

                        <div class="form-group">
                            <label for="weight" class="form-label">Weight (kg)</label>
                            <input type="number" id="weight" name="weight" class="form-control" value="{{ user.weight or '' }}">
                        </div>

                        <div class="form-group">
                            <label for="gender" class="form-label">Gender</label>
                            <select id="gender" name="gender" class="form-control">
                                <option value="">Select gender...</option>
                                <option value="male" {% if user.gender == 'male' %}selected{% endif %}>Male</option>
                                <option value="female" {% if user.gender == 'female' %}selected{% endif %}>Female</option>
                                <option value="other" {% if user.gender == 'other' %}selected{% endif %}>Other</option>
                            </select>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Changes
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</section>

<script>
    // Preview the selected image
    document.getElementById('avatar').addEventListener('change', function(e) {
        const preview = document.getElementById('avatarPreview');
        const placeholder = document.querySelector('.avatar-placeholder');
        
        if (this.files && this.files[0]) {
            const reader = new FileReader();
            
            reader.onload = function(e) {
                if (placeholder) placeholder.style.display = 'none';
                if (!preview) {
                    const img = document.createElement('img');
                    img.id = 'avatarPreview';
                    img.src = e.target.result;
                    img.alt = 'Profile Preview';
                    document.querySelector('.avatar-preview').prepend(img);
                } else {
                    preview.src = e.target.result;
                }
            }
            
            reader.readAsDataURL(this.files[0]);
        }
    });
</script>
{% endblock %}